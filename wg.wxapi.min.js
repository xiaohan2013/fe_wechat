console.log("wxapijs loaded..."),
	function() {
		function a() {
			window.WeixinJSBridge && WeixinJSBridge.invoke("setCloseWindowConfirmDialogInfo", {
				"switch": "true",
				title_cn: "你要关闭购物页面?",
				title_eng: "Do not save the order info? ",
				ok_cn: "关闭",
				ok_eng: "OK",
				cancel_cn: "再逛逛",
				cancel_eng: "Cancel"
			}, function() {})
		}
		try {
			window.WeixinJSBridge ? a() : document.addEventListener("WeixinJSBridgeReady", function() {
				a()
			})
		} catch (b) {}
	}(),
	function() {
		function a(a, b) {
			try {
				var c = JSON.parse(sessionStorage.getItem(t)) || {};
				c[a] = b, sessionStorage.setItem(t, JSON.stringify(c))
			} catch (d) {}
		}

		function b(a) {
			var b;
			try {
				return window.JSON ? (b = JSON.parse(sessionStorage.getItem(t)) || {}, b ? b[a] : null) : null
			} catch (c) {
				return null
			}
		}

		function c() {
			var a;
			try {
				window.JSON && (a = JSON.parse(sessionStorage.getItem(t)), a[l] && delete a[l])
			} catch (b) {
				return null
			}
		}

		function d(a) {
			var d = (new Date).getTime(),
				e = null;
			a ? (i = 0, sessionStorage && c(), window.wx || (j = 0, JD.events.trigger(o))) : e = b(l), e && d - 1e3 * e.timestamp < 66e5 ? JD.wxapi.signatureReady(e) : f()
		}

		function e(a) {
			JD.events.trigger(p, a), JD.events.remove(p), JD.events.remove(m);
			try {
				JD.report.umpBiz({
					bizid: "55",
					operation: "20",
					result: a.errorCode,
					source: "0",
					message: JSON.stringify(a)
				})
			} catch (b) {}
		}

		function f() {
			JD.sendJs(q + "?url=" + encodeURIComponent(location.href.split("#")[0]) + "&callback=getwxjssign2&t=" + Math.random(), {
				defer: !0,
				async: !0
			}), window.getwxjssign2 = function(b) {
				console.log("iSignErrCount..." + i), 0 == b.errCode ? (JD.wxapi.signatureReady(b), a(l, b)) : i > 2 ? e({
					errorCode: 1,
					errMsg: "签名错误"
				}) : (JD.events.trigger(n, !0), i++)
			}
		}

		function g() {
			JD.sendJs(r + s, {
				onLoad: function() {
					JD.wxapi.jsReady(function(a) {
						var b = !1,
							c = ["checkJsApi", "getNetworkType", "onMenuShareTimeline", "onMenuShareAppMessage", "onMenuShareQQ", "onMenuShareWeibo", "hideMenuItems", "showMenuItems", "editAddress", "previewImage", "uploadImage", "chooseImage", "setCloseWindowConfirmDialogInfo", "startRecord", "stopRecord", "onVoiceRecordEnd", "playVoice", "pauseVoice", "stopVoice", "onVoicePlayEnd", "uploadVoice", "getLocation", "openLocation"];
						console.log("begin config wx"), wx.error(function(a) {
							console.log("config error"), -1 !== a.errMsg.indexOf("invalid signature") && 0 === k ? (k++, b = !0, JD.events.trigger(n, !0)) : e({
								errorCode: 3,
								errMsg: "JS其他错误"
							})
						}), wx.ready(function() {
							b || (console.log("config ready"), wx.checkJsApi({
								jsApiList: c,
								success: function(a) {
									wx.apiCheckResult = a.checkResult, JD.events.trigger(m, JD.wxapi.getSignature()), JD.events.remove(m), JD.wxapi.wxReady()
								}
							}))
						}), wx.config({
							beta: !0,
							debug: !1,
							appId: a.appId,
							timestamp: a.timestamp,
							nonceStr: a.nonceStr,
							signature: a.signature,
							jsApiList: c
						})
					})
				},
				onError: function() {
					console.log("iJsSdkErrCount..." + j), j > 2 ? e({
						errorCode: 2,
						errMsg: "js加载错误"
					}) : (j++, s = "?" + Date.now(), JD.events.trigger(o))
				},
				defer: !0,
				async: !0
			})
		}

		function h() {
			if (window.WeixinJSBridge) JD.events.trigger(o);
			else {
				if (u > 10) return void e({
					errorCode: 3,
					errMsg: "loadJSAPI加载错误"
				});
				setTimeout(function() {
					console.log("loadJSAPI延时调用:" + 300 * (u + 1) + "ms"), u++, h()
				}, 300)
			}
		}
		try {
			var i = 0,
				j = 0,
				k = 0,
				l = "_wx_signature" + encodeURIComponent(location.href.split("#")[0]),
				m = "wx_api_ready",
				n = "wx_sign_get",
				o = "wx_js_get",
				p = "wx_api_error",
				q = "http://wq.jd.com/bases/jssdk/GetWxJsApiSign",
				r = "http://res.wx.qq.com/open/js/jweixin-1.0.0.js",
				s = "",
				t = "_wx_api_store";
			JD.events.listen(n, d, !1), JD.events.listen(o, g), console.log("begin load js");
			var u = 0;
			window.WeixinJSBridge ? h() : document.addEventListener("WeixinJSBridgeReady", function() {
				console.log(WeixinJSBridge ? "bridge init OK" : "bridge init error"), h()
			}), window.GLOBAL_FORBIT_WXAPI || (JD.events.trigger(n), JD.report.umpBiz({
				bizid: "55",
				operation: "20",
				result: "0",
				source: "0",
				message: ""
			}))
		} catch (v) {}
	}(),
	function() {
		function a() {
			function a() {
				wx.showOptionMenu()
			}

			function d() {
				function a(a, b, c) {
					a.shareCallback && a.shareCallback(a.scene, b, c.errMsg)
				}

				function b(a) {
					function b() {}
					b.prototype = a;
					var c = new b;
					return c
				}

				function d() {
					var a, b = window.shareConfig || g;
					return b.link = JD.url.addRd(b.link, "17053.1.1"), b.link && -1 == b.link.indexOf("_share=") && (b.url = b.link + (-1 === b.link.indexOf("?") ? "?" : "&") + "_share=wx"), c && (b.shareCallback = function(a, b, c) {
						console.log(a + "-" + b + "-" + c)
					}), a = {
						shareCallback: b.shareCallback,
						title: b.title,
						desc: b.desc,
						link: b.link,
						imgUrl: b.img_url
					}
				}

				function e() {
					var b = {
						success: function(b) {
							a(this, "ok", b)
						},
						cancel: function(b) {
							a(this, "cancel", b)
						},
						fail: function(b) {
							a(this, "fail", b)
						}
					};
					return b
				}

				function f(a) {
					var c = b(e());
					return c.trigger = function() {
						var a = d();
						this.shareCallback = a.shareCallback, this.title = a.title, this.desc = a.desc, this.link = a.link, this.imgUrl = a.imgUrl, "shareTimeline" === this.scene && (this.title = a.desc)
					}, c.scene = a, c
				}
				wx.onMenuShareAppMessage(f("sendAppMessage")), wx.onMenuShareTimeline(f("shareTimeline")), wx.onMenuShareWeibo(f("shareWeibo")), wx.onMenuShareQQ(f("shareQQ"));
				var g = {
					img_url: "http://img11.360buyimg.com/jdphoto/s80x80_jfs/t1408/252/328693211/4515/ee0dd8ca/55764b01Ne116d1d1.png",
					link: "http://wq.jd.com/mcoss/mportal/show?tpl=14&tabid=5",
					title: "【品牌闪购】正品低价，精选大牌限时抢购！",
					desc: "每天9点为你推荐特价品牌，正品低价就来微信品牌闪购，超多大牌等你抢！"
				}
			}

			function e() {
				wx.getNetworkType({
					success: function(a) {
						var b = a.networkType;
						/wifi/i.test(b) ? b = "wifi" : /4g|3g+/i.test(b) ? b = "4g" : /3g/i.test(b) ? b = "3g" : /2g/i.test(b) && (b = "2g"), JD.cookie.set("network", b, 2, "/", "jd.com"), window.FOOTDETECT && (window.FOOTDETECT.network = b)
					},
					fail: function() {}
				})
			}
			if (!b && wx.apiCheckResult) {
				var f = wx.apiCheckResult;
				f.getNetworkType && e(), f.onMenuShareTimeline && d(), f.showMenuItems && a(), b = !0
			}
		}
		var b = !1,
			c = !1;
		JD.wxapi.ready(function(b) {
			a(b)
		})
	}();